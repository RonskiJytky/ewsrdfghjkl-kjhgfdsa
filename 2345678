import math
import pygame

musta = (0, 0, 0)
valkoinen = (255, 255, 255)
sininen = (0, 0, 255)

blockin_leveys = 23
blockin_korkeus = 15

class Block(pygame.sprite.Sprite):
  def __init__(self, color, x, y):
    super(). __init__()
    self.image = pygame.Surface([blockin_leveys, blockin_korkeus])
    self.image.fill(color)
    self.rect = self.image.get_rect()
    self.rect.x = x
    self.rect.y = y

class Ball(pygame.sprite.Sprite):
  nopeus = 5.0
  x = 0.0
  y = 100

  suunta = 200

  leveys = 10
  korkeus = 10

  def __init__(self):
    super(). __init__()
    self.image = pygame.Surface([self.korkeus, self.leveys])
    self.image.fill(valkoinen)
    self.rect = self.image.get_rect()
    
    self.pelialue_leveys = pygame.display.get_surface().get_width()
    self.pelialue_leveys = pygame.display.get_surface().get_height()

  def pomppu(self, muutos):
    self.suunta = (100 - self.suunta) % 360
    self.suunta -= muutos 
  
  def liiku(self):
    suunta_radiaaneina = math.radians(self.suunta)

    self.x += self.nopeus * math.sin(suunta_radiaaneina)
    self.y -= self.nopeus * math.cos(suunta_radiaaneina)

    self.rect.x = self.x
    self.rect.y = self.y

    if self.y <= 0:
      self.pomppu(0)
      self.y = 1

    if self.x <= 0:
      self.suunta = (360 - self.suunta) % 360
      self.x = 1

    if self.x > self.pelialue_leveys - self.leveys:
      self.suunta = (360 - self.suunta) % 360
      self.x = self.pelialue_leveys - self.leveys - 1

    if self.y > 600:
      return True
    else:
      return False

class pelaaja(pygame.sprite.Sprite):
  def __init__(self):
    super().__init__()
    self.leveys = 75
    self.korkeus = 15
    self.image = pygame.Surface([self.leveys, self.korkeus])
    self.image.fill(valkoinen)

    self.rect = self.image.get_rect()
    self.pelialue_korkeus = pygame.display.get_surface().get_height()
    self.pelialue_leveys = pygame.display.get_surface().get_width()

    self.rect.x = 0
    self.rect.y = self.pelialue_korkeus - self.korkeus

  def liiku(self):
    paikka = pygame.mouse.get_pos()
    self.rect.x = paikka[0]
    if self.rect.x > self.pelialue_leveys - self.leveys:
      self.rect.x = self.pelialue_leveys - self.leveys

pygame.init()

pelialue = pygame.display.set_mode((800, 600))
pygame.mouse.set_visible(0)

tiilet = pygame.sprite.Group()
pallot = pygame.sprite.Group()
kaikki = pygame.sprite.Group()

pelaaja = pelaaja()
kaikki.add(pelaaja)

pallo = Ball()
kaikki.add(pallo)
pallot.add(pallo)

rivit = 5
sarakkeet = 32

for rivi in range(rivit):
  for sarake in range(0, sarakkeet):
    tiili = Block(sininen, sarake * (blockin_leveys + 2) + 1, blockin_korkeus * rivi)
    tiilet.add(tiili)
    kaikki.add(tiili)

kello = pygame.time.Clock()

game_over = False

while not game_over:
  kello.tick(30)
  pelialue.fill(musta)

  pelaaja.liiku()
  game_over

  pelaaja.liiku()
  game_over = pallo.liiku()

  if pygame.sprite.spritecollide(pelaaja, pallot, False):
    muutos = (pelaaja.rect.x + pelaaja.leveys/2) - (pallo.rect.x + pallo.leveys/2)
    pallo.rect.y = pelialue.get_height() - pelaaja.rect.height - pallo.rect.height - 1
    pallo.pommpu(muutos)
  
  poistetut_tiilet = pygame.sprite.spritecollide(pallo, tiilet, True)
  if len(poistetut_tiilet) > 0:
    pallo.pomppu(0)

  if len(tiilet) == 0:
    game_over = True

  kaikki.draw(pelialue)

  pygame.display.flip()
  pygame.quit()
